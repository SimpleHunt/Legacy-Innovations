generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id                           Int         @id @default(autoincrement())
  email                        String?     @unique
  password                     String?
  fullname                     String?
  phone                        String      @unique
  role                         role
  isactive                     Boolean?    @default(true)
  loginuserid                  String?     @unique
  createdat                    DateTime?   @default(now()) @db.Timestamp(6)
  updatedat                    DateTime?   @default(now()) @db.Timestamp(6)
  Customer                     Customer[]
  Franchise                    Franchise[]
  Order_Order_createdbyToUser  Order[]     @relation("Order_createdbyToUser")
  Order_Order_employeeidToUser Order[]     @relation("Order_employeeidToUser")
  Product                      Product[]
}

model enquiry {
  enquiryid  Int       @id @default(autoincrement())
  name       String
  owneremail String    @unique
  ownername  String?
  ownerphone String    @unique
  address    String?
  status     Int
  createdby  Int?
  createdat  DateTime? @default(now()) @db.Timestamp(6)
  updatedat  DateTime? @default(now()) @db.Timestamp(6)
}

model Franchise {
  id             Int        @id @default(autoincrement())
  name           String
  code           String     @unique
  address        String?
  owneremail     String     @unique
  ownername      String?
  ownerphone     String     @unique
  companyprofile String?
  companykyc     String?
  bankdetails    String?
  itrdocs        String?
  isactive       Boolean?   @default(true)
  createdby      Int?
  createdat      DateTime?  @default(now()) @db.Timestamp(6)
  updatedat      DateTime?  @default(now()) @db.Timestamp(6)
  Customer       Customer[]
  User           User?      @relation(fields: [createdby], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_franchise_creator")
  Order          Order[]
}

model Customer {
  id           Int        @id @default(autoincrement())
  name         String
  email        String?
  phone        String?
  address      String?
  customertype String?
  cusotmercode String     @unique
  franchiseid  Int?
  createdby    Int?
  employeeid   Int?
  createdat    DateTime?  @default(now()) @db.Timestamp(6)
  updatedat    DateTime?  @default(now()) @db.Timestamp(6)
  User         User?      @relation(fields: [employeeid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_customer_employee")
  Franchise    Franchise? @relation(fields: [franchiseid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_customer_franchise")
  Order        Order[]
}

model Product {
  id          Int       @id @default(autoincrement())
  name        String
  price       Float
  stock       Int?      @default(0)
  isactive    Boolean?  @default(true)
  size        String
  productcode String    @unique
  createdbyid Int?
  createdat   DateTime? @default(now()) @db.Timestamp(6)
  updatedat   DateTime? @default(now()) @db.Timestamp(6)
  Order       Order[]
  User        User?     @relation(fields: [createdbyid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_product_creator")
}

model Order {
  id                          Int        @id @default(autoincrement())
  ordernumber                 String     @unique
  status                      String?    @default("PENDING")
  expecteddeliverydate        DateTime?  @db.Timestamp(6)
  defectedstatus              Int?
  defexpecteddate             DateTime?  @default(now()) @db.Timestamp(6)
  unitprice                   Float?     @default(0)
  unitpricecost               Float?     @default(0)
  discountdate                DateTime   @db.Timestamp(6)
  discount                    Float?     @default(0)
  gstpercentage               Float?     @default(0)
  gstamount                   Float?     @default(0)
  totalamount                 Float?     @default(0)
  climate                     climate
  terrain                     terrain
  employeeid                  Int?
  createdby                   Int?
  productid                   Int
  franchiseid                 Int?
  customerid                  Int?
  createdat                   DateTime?  @default(now()) @db.Timestamp(6)
  updatedat                   DateTime?  @default(now()) @db.Timestamp(6)
  Factory                     Factory?
  User_Order_createdbyToUser  User?      @relation("Order_createdbyToUser", fields: [createdby], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_order_created_by")
  Customer                    Customer?  @relation(fields: [customerid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_order_customer")
  User_Order_employeeidToUser User?      @relation("Order_employeeidToUser", fields: [employeeid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_order_employee")
  Franchise                   Franchise? @relation(fields: [franchiseid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_order_franchise")
  Product                     Product    @relation(fields: [productid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_order_product")
  Payment                     Payment[]
}

model Factory {
  id           Int       @id @default(autoincrement())
  orderid      Int       @unique
  orderstatus  String?   @default("PROCESSING")
  deliverydate DateTime? @db.Timestamp(6)
  createdat    DateTime? @default(now()) @db.Timestamp(6)
  Order        Order     @relation(fields: [orderid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_factory_order")
}

model Payment {
  id        Int       @id @default(autoincrement())
  amount    Float
  orderid   Int
  status    String?   @default("PENDING")
  method    String
  createdat DateTime? @default(now()) @db.Timestamp(6)
  updatedat DateTime? @default(now()) @db.Timestamp(6)
  Order     Order     @relation(fields: [orderid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_payment_order")
}

enum climate {
  HUMID
  COLD
}

enum paymentmethod {
  CASH
  CARD
  UPI
  BANK_TRANSFER
}

enum role {
  SUPER_ADMIN
  ADMIN
  FACTORY
  EMPLOYEE
  FRANCHISE
  CUSTOMER
}

enum terrain {
  FLAT
  HILL_STATION
}
